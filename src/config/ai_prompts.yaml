# üìç src/config/ai_prompts.yaml
#
# Configuration centralis√©e des prompts et templates pour l'AIService
# Permet l'ajustement facile des prompts sans recompilation
# Version: 1.0

# =============================================================================
# CONFIGURATION MODELES OLLAMA
# =============================================================================
models:
  vision: "llava:7b"
  caption: "mistral:7b-instruct" 
  geo_enrichment: "qwen2:7b"
  travel_llama: "llama3.1:70b"  # Nouveau mod√®le pour enrichissement voyage
  travel_llama_fallback: "mistral:7b-instruct"  # Fallback


ollama:
  base_url: "http://localhost:11434"
  timeout: 60
  default_temperature: 0.7
  max_retries: 3

# =============================================================================
# TEMPLATES DE PROMPTS - hashtags
# =============================================================================

hashtags_generation:
  prompt: |
    G√©n√®re 5 √† 8 hashtags Instagram pertinents pour cette photo.

    üì∏ IMAGE: {image_description}
    üìç LIEU: {location_basic}
    üèõÔ∏è CONTEXTE: {cultural_context}
    üåç INFOS VOYAGE: {travel_enrichment}

    R√àGLES:
    - Mix de hashtags populaires et sp√©cifiques
    - Inclure le lieu et le pays
    - Au moins 1 hashtag en langue locale
    - Format: #mot (pas d'espaces)
    - Pertinents pour Instagram travel

    Retourne UNIQUEMENT les hashtags s√©par√©s par des espaces.

  parameters:
    temperature: 0.6
    max_tokens: 50


# =============================================================================
# TEMPLATES DE PROMPTS - Travel Llama
# =============================================================================

travel_enrichment:
  fallback_prompt: |
    Enrichis cette description avec des infos touristiques.
    Lieu: {location_basic}
    
    Ajoute 2-3 faits int√©ressants sur:
    - Histoire ou culture locale
    - Attractions touristiques
    - Sp√©cialit√©s r√©gionales
    
    Style: Guide touristique enthousiaste
    Max 80 mots.

  main_prompt: |
    Tu es Travel Llama, un expert passionn√© de voyage et de culture locale.
    Enrichis cette description avec des informations touristiques captivantes.

    üìç LIEU: {location_basic}
    üèõÔ∏è CONTEXTE ACTUEL: {cultural_context}
    üåç ATTRACTIONS PROCHES: {nearby_attractions}
    üì∏ DESCRIPTION DE L'IMAGE: {image_description}

    üéØ FOURNIS DES INFOS CAPTIVANTES SUR:
    - Histoire fascinante et anecdotes m√©connues du lieu
    - Traditions locales authentiques et festivals
    - Gastronomie et sp√©cialit√©s √† ne pas manquer
    - L√©gendes locales et myst√®res
    - Meilleurs moments pour visiter
    - Conseils d'initi√©s que seuls les locaux connaissent
    - Exp√©riences uniques √† vivre sur place

    ‚úÖ STYLE:
    - Passionn√© et inspirant, comme un ami qui partage ses coups de c≈ìur
    - Informatif mais jamais ennuyeux
    - Maximum 150 mots
    - √âvite les clich√©s touristiques
    - Donne envie de d√©couvrir le lieu

  parameters:
    temperature: 0.8
    max_tokens: 200
    top_p: 0.9


# =============================================================================
# TEMPLATES DE PROMPTS - ANALYSE D'IMAGE
# =============================================================================
image_analysis:
  # Prompt principal pour LLaVA
  main_prompt: |
    Analyse cette image et d√©cris ce que tu vois de mani√®re pr√©cise et objective.

    Focus sur:
    - Les √©l√©ments principaux (personnes, objets, architecture, nature)
    - L'ambiance et l'atmosph√®re g√©n√©rale
    - Les couleurs dominantes et la luminosit√©
    - Le style architectural ou artistique si identifiable
    - L'activit√© ou la situation captur√©e
    - Le moment de la journ√©e approximatif

    Sois concis mais informatif. Maximum 150 mots.
    √âvite les interpr√©tations subjectives, reste factuel.

  # Prompt pour analyse d√©taill√©e (si n√©cessaire)
  detailed_prompt: |
    Fais une analyse approfondie de cette image pour une l√©gende Instagram.
    
    D√©cris:
    1. COMPOSITION: Cadrage, perspective, points focaux
    2. CONTENU: √âl√©ments visuels principaux et secondaires  
    3. AMBIANCE: Mood, √©motion transmise, atmosph√®re
    4. TECHNIQUE: √âclairage, couleurs, style photographique
    5. CONTEXTE: Indices sur le lieu, l'√©poque, l'√©v√©nement
    
    Format: Paragraphe fluide, pas de listes. Maximum 200 mots.

  # Param√®tres sp√©cifiques LLaVA
  parameters:
    temperature: 0.6
    max_tokens: 300
    top_p: 0.9

# =============================================================================
# TEMPLATES DE LEGENDS - FRAN√áAIS
# =============================================================================
captions_french:
  # Style cr√©atif/po√©tique
  creative: |
    Cr√©e une l√©gende Instagram po√©tique et authentique en fran√ßais pour cette photo.

    üì∏ DESCRIPTION DE L'IMAGE:
    {image_description}

    üìç CONTEXTE G√âOGRAPHIQUE:
    - Lieu: {location_basic}
    - Contexte culturel: {cultural_context}
    - Attractions proches: {nearby_attractions}
    - Enrichissement: {cultural_enrichment}

    üåç INFOS TRAVEL LLAMA:
      {travel_enrichment}
      
    üé® STYLE DEMAND√â:
    - √âmotionnel et √©vocateur, capture l'essence du moment
    - Authentique et personnel, pas de ton marketing
    - Entre 80-120 mots maximum
    - Ton inspirant qui donne envie de voyager
    - AUCUN hashtag, aucun emoji dans le texte
    - Une seule langue (fran√ßais uniquement)

    ‚úçÔ∏è CONSIGNES:
    √âcris une l√©gende qui raconte une histoire, √©voque une √©motion et cr√©e une connexion avec ce lieu unique. 
    Utilise des m√©taphores subtiles et un vocabulaire riche mais accessible.

  # Style descriptif
  descriptive: |
    √âcris une l√©gende Instagram descriptive en fran√ßais pour cette photo.

    üì∏ Description: {image_description}
    üìç Lieu: {location_basic}
    üèõÔ∏è Contexte: {cultural_context}

    Style:
    - Informatif mais engageant  
    - 60-100 mots
    - Ton naturel et accessible
    - Focus sur les faits int√©ressants du lieu
    - Pas de hashtags

    D√©cris ce qu'on voit et o√π c'est, avec des d√©tails captivants sur le lieu.

  # Style minimaliste 
  minimal: |
    Cr√©e une l√©gende Instagram minimaliste en fran√ßais.

    Image: {image_description}
    Lieu: {location_basic}

    Style:
    - Tr√®s court (30-50 mots maximum)
    - Po√©tique et √©vocateur
    - Une phrase percutante ou une r√©flexion courte
    - Pas de hashtags

    Capture l'essence en quelques mots seulement.

# =============================================================================
# TEMPLATES DE LEGENDS - ANGLAIS  
# =============================================================================
captions_english:
  # Style cr√©atif/po√©tique
  creative: |
    Create a poetic and authentic Instagram caption in English for this photo.

    üì∏ IMAGE DESCRIPTION:
    {image_description}

    üìç GEOGRAPHIC CONTEXT:
    - Location: {location_basic}
    - Cultural context: {cultural_context}
    - Nearby attractions: {nearby_attractions}
    - Cultural enrichment: {cultural_enrichment}

    üé® STYLE REQUIREMENTS:
    - Emotional and evocative, capturing the moment's essence
    - Authentic and personal, not marketing-like
    - 80-120 words maximum
    - Inspiring tone that makes people want to travel
    - NO hashtags, NO emojis in the text
    - Single language (English only)

    ‚úçÔ∏è GUIDELINES:
    Write a caption that tells a story, evokes emotion, and creates connection with this unique place.
    Use subtle metaphors and rich but accessible vocabulary.

  # Style descriptif
  descriptive: |
    Write a descriptive Instagram caption in English for this photo.

    üì∏ Description: {image_description}
    üìç Location: {location_basic}  
    üèõÔ∏è Context: {cultural_context}

    Style:
    - Informative but engaging
    - 60-100 words
    - Natural and accessible tone
    - Focus on interesting facts about the place
    - No hashtags

    Describe what we see and where it is, with captivating details about the location.

  # Style minimaliste
  minimal: |
    Create a minimalist Instagram caption in English.

    Image: {image_description}
    Location: {location_basic}

    Style:
    - Very short (30-50 words maximum)
    - Poetic and evocative
    - One powerful sentence or short reflection
    - No hashtags

    Capture the essence in just a few words.

# =============================================================================
# TEMPLATES BILINGUES
# =============================================================================
captions_bilingual:
  creative: |
    Cr√©e une l√©gende Instagram bilingue (fran√ßais ET anglais) pour cette photo.

    üì∏ Image: {image_description}
    üìç Lieu: {location_basic}
    üèõÔ∏è Contexte: {cultural_context}

    Format OBLIGATOIRE:
    üá´üá∑ [L√©gende fran√ßaise po√©tique, 60-80 mots]
    
    üá¨üáß [English poetic caption, 60-80 words]

    Style: Authentique, √©vocateur, pas de hashtags.
    Les deux versions doivent avoir le m√™me esprit mais pas √™tre des traductions litt√©rales.

# =============================================================================
# ENRICHISSEMENT CULTUREL
# =============================================================================
cultural_enrichment:
  # Prompt principal pour Qwen2
  main_prompt: |
    Enrichis ce contexte g√©ographique avec des informations culturelles et historiques pertinentes pour une l√©gende Instagram.

    üìç LIEU: {location_basic}
    üìö CONTEXTE ACTUEL: {current_context}

    üéØ AJOUTE DES D√âTAILS SUR:
    - Histoire significative ou anecdotes du lieu
    - Traditions locales importantes ou uniques  
    - Caract√©ristiques g√©ographiques remarquables
    - Aspects culturels distinctifs
    - Importance dans l'art, la litt√©rature ou le cin√©ma

    ‚úÖ CONSIGNES:
    - Reste factuel et v√©rifiable
    - Maximum 80 mots
    - Ton accessible, pas acad√©mique
    - Information qui enrichit sans √™tre pesante
    - √âvite les clich√©s touristiques

  # Version courte pour contexte limit√©
  short_prompt: |
    Ajoute 1-2 faits culturels int√©ressants sur: {location_basic}
    
    Contexte existant: {current_context}
    
    Style: Factuel, concis (40 mots max), accessible.

  # Param√®tres Qwen2
  parameters:
    temperature: 0.5
    max_tokens: 120
    top_p: 0.8

# =============================================================================
# CONFIGURATION POST-PROCESSING
# =============================================================================
post_processing:
  # Mots/phrases √† nettoyer
  remove_patterns:
    - "^#.*$"  # Hashtags en d√©but de ligne
    - "\\*{2,}"  # Markdown bold/italic
    - "_{2,}"   # Markdown underline
    - "```.*?```"  # Code blocks
    - "üìç|üåç|üé®|‚ú®|üèõÔ∏è"  # Emojis courants (optionnel)

  # Longueurs limites
  max_caption_length: 500
  min_caption_length: 20
  max_sentences_if_too_long: 3

  # Mots interdits (spam/marketing)
  forbidden_words:
    - "like and subscribe"
    - "follow for more"
    - "link in bio" 
    - "swipe up"
    - "click here"

# =============================================================================
# MESSAGES D'ERREUR ET FALLBACKS
# =============================================================================
fallback_messages:
  french:
    no_image: "Une belle image captur√©e √† {location_basic}, o√π chaque moment raconte une histoire unique."
    no_location: "Un instant magique fig√© dans le temps, porteur d'√©motions et de souvenirs."
    generic_error: "Une photo qui capture l'essence d'un moment pr√©cieux."
    
  english:
    no_image: "A beautiful moment captured at {location_basic}, where every instant tells a unique story."
    no_location: "A magical moment frozen in time, carrying emotions and memories."
    generic_error: "A photo that captures the essence of a precious moment."

# =============================================================================
# SCORING ET QUALIT√â
# =============================================================================
quality_scoring:
  # Poids pour calcul score de confiance
  weights:
    image_analysis: 0.3
    geo_context: 0.4  
    caption_quality: 0.3

  # Crit√®res qualit√© l√©gende
  caption_quality_factors:
    min_words: 10
    max_words: 150
    ideal_words_min: 40
    ideal_words_max: 120
    bonus_for_metaphors: 0.1
    penalty_hashtags: -0.2
    penalty_emojis: -0.1

# =============================================================================
# CONFIGURATION DE DEBUG
# =============================================================================
debug:
  log_prompts: false
  log_responses: false  
  save_failed_generations: true
  detailed_timing: false

# =============================================================================  
# LANGUES SUPPORT√âES
# =============================================================================
supported_languages:
  - code: "fr"
    names: ["fran√ßais", "french", "fr"]
    template_key: "captions_french"
    
  - code: "en" 
    names: ["english", "anglais", "en"]
    template_key: "captions_english"
    
  - code: "bilingual"
    names: ["bilingual", "bilingue", "multi"]
    template_key: "captions_bilingual"

# =============================================================================
# STYLES SUPPORT√âS
# =============================================================================
supported_styles:
  - name: "creative"
    description: "Po√©tique et √©vocateur"
    default: true
    
  - name: "descriptive" 
    description: "Informatif et engageant"
    
  - name: "minimal"
    description: "Court et percutant"